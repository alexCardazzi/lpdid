<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Alexander Cardazzi" />

<meta name="date" content="2024-05-16" />

<title>Local Projections Difference-in-Differences</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Local Projections
Difference-in-Differences</h1>
<h4 class="author">Alexander Cardazzi</h4>
<h4 class="date">2024-05-16</h4>



<div id="getting-started" class="section level2">
<h2>Getting Started</h2>
<p>Please see the working paper on which this package is based <a href="https://www.nber.org/papers/w31184">here (Dube et al.,
2023)</a>.</p>
<p>To install and load this package, use the following code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="st">&quot;devtools&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) <span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="st">&quot;lpdid&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;alexCardazzi/lpdid&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lpdid&quot;</span>)</span></code></pre></div>
</div>
<div id="a-simple-2x2-did-example" class="section level2">
<h2>A Simple 2x2 DiD Example</h2>
<p>To begin, consider a simple 2x2 DiD where treatment begins at <span class="math inline">\(t = 31\)</span>. Only twenty out of fifty units
get treated, and the treatment dynamics cause the outcome variable to
increase linearly with time. Below, the outcome is averaged by time and
whether the unit receives treatment at some point.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;fixest&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">757</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">50</span>; T <span class="ot">&lt;-</span> <span class="dv">50</span>; N <span class="ot">&lt;-</span> I <span class="sc">*</span> T</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>I, <span class="at">each =</span> T),</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>           <span class="at">t =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>T, I),</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>           <span class="at">e =</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">4</span>)) <span class="ot">-&gt;</span> df</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>unit_FE <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(I, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>time_FE <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(T, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>df<span class="sc">$</span>treated <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">21</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>df<span class="sc">$</span>time_til <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>treated <span class="sc">==</span> <span class="dv">1</span>, df<span class="sc">$</span>t <span class="sc">-</span> <span class="dv">30</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>df<span class="sc">$</span>treat_status <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>treated <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> df<span class="sc">$</span>t <span class="sc">==</span> <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>df<span class="sc">$</span>y <span class="ot">&lt;-</span> df<span class="sc">$</span>e <span class="sc">+</span> unit_FE[df<span class="sc">$</span>id] <span class="sc">+</span> time_FE[df<span class="sc">$</span>t] <span class="sc">+</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">21</span> <span class="sc">&amp;</span> df<span class="sc">$</span>t <span class="sc">&gt;</span> <span class="dv">30</span>, df<span class="sc">$</span>t <span class="sc">-</span> <span class="dv">30</span>, <span class="dv">0</span>)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="fu">aggregate</span>(df<span class="sc">$</span>y, <span class="fu">list</span>(df<span class="sc">$</span>t, df<span class="sc">$</span>treated), mean) <span class="ot">-&gt;</span> tmp</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, .<span class="dv">1</span>, <span class="fl">4.1</span>))</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="fu">plot</span>(tmp<span class="sc">$</span>Group<span class="fl">.1</span>, tmp<span class="sc">$</span>x, <span class="at">col =</span> tmp<span class="sc">$</span>Group<span class="fl">.2</span> <span class="sc">+</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Outcome&quot;</span>)</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Treated&quot;</span>, <span class="st">&quot;Control&quot;</span>),</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In the most simple of cases, LP-DiD and TWFE preform very similarly.
Of course, TWFE is not biased in this setting, so we observe nearly
identical parameter estimates (and standard errors). The important
arguments for <code>lpdid()</code> are the following:</p>
<ul>
<li><code>df</code>: The analysis dataset.</li>
<li><code>window</code>: This is the pre- and post-period lengths in
terms of time. Importantly, the first value must be negative and the
second must be positive.</li>
<li><code>y</code>: The name of the outcome variable.</li>
<li><code>unit_index</code>, <code>time_index</code>: unit and time
indices. For example, if the data is state-by-year, this is where you
would input these names.</li>
<li><code>treat_status</code>: This should be a vector equal to one for
the time period a unit is treated. Never-treated units will have all
zeros for this vector.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">lpdid</span>(df, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>      <span class="at">unit_index =</span> <span class="st">&quot;id&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>      <span class="at">treat_status =</span> <span class="st">&quot;treat_status&quot;</span>) <span class="ot">-&gt;</span> reg</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">i</span>(time_til, treated, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">|</span> id <span class="sc">+</span> t, <span class="at">data =</span> df) <span class="ot">-&gt;</span> twfe</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, .<span class="dv">1</span>, <span class="fl">4.1</span>))</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">plot_lpdid</span>(reg, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">iplot</span>(twfe, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;TWFE&quot;</span>, <span class="st">&quot;LP-DiD&quot;</span>),</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;tomato&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">19</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="staggered-exogenous-treatment-timing" class="section level2">
<h2>Staggered (Exogenous) Treatment Timing</h2>
<p>If you are reading this, it is likely that you are aware that TWFE
estimates are potentially biased depending on treatment timing and
dynamics. In Dube et al. (2023), the authors simulate two sets of data:
one where treatment timing is exogenous and the other where it is
endogenous. First, LP-DiD is applied to the data where treatment is
exogenous.</p>
<p><code>lpdid</code> has a built-in function to replicate (as closely
as possible) the simulations in Dube et al. (2023).<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Using this, we
estimate TWFE and LP-DiD models in addition to plotting the “true”
average beta values.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">genr_sim_data</span>(<span class="at">exogenous_timing =</span> <span class="cn">TRUE</span>, <span class="dv">789</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>twfe1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">i</span>(rel_time, ever_treat, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">|</span> i <span class="sc">+</span> t, <span class="at">data =</span> df)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>lpdid1 <span class="ot">&lt;-</span> <span class="fu">lpdid</span>(df, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                <span class="at">unit_index =</span> <span class="st">&quot;i&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                <span class="at">treat_status =</span> <span class="st">&quot;treat_status&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, .<span class="dv">1</span>, <span class="fl">4.1</span>))</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="fu">plot_lpdid</span>(lpdid1, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>, <span class="at">x.shift =</span> <span class="fl">0.1</span>)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">iplot</span>(twfe1, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">x.shift =</span> <span class="sc">-</span><span class="fl">0.1</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">aggregate</span>(df<span class="sc">$</span>beta[df<span class="sc">$</span>ever_treat <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>                 <span class="fu">list</span>(df<span class="sc">$</span>rel_time[df<span class="sc">$</span>ever_treat <span class="sc">==</span> <span class="dv">1</span>]), mean))</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;True Beta&quot;</span>, <span class="st">&quot;TWFE&quot;</span>, <span class="st">&quot;LP-DiD&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>, <span class="dv">19</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;tomato&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="staggered-endogenous-treatment-timing" class="section level2">
<h2>Staggered (Endogenous) Treatment Timing</h2>
<p>For endogenous treatment timing, the main idea is that treatment is
more likely following a large negative shock. See page 28 of the paper
for more details on this. However, given this, we can include a lag of
the outcome variable into the model. Below, four event studies are
plotted: TWFE and LP-DiD, both with and without a lag of the
outcome.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">genr_sim_data</span>(<span class="at">exogenous_timing =</span> <span class="cn">FALSE</span>, <span class="dv">789</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># The returned &quot;df&quot; is a pdata.frame, so lag() works in a panel setting.</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>df<span class="sc">$</span>lag_y <span class="ot">&lt;-</span> <span class="fu">lag</span>(df<span class="sc">$</span>y, <span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>twfe0 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">i</span>(rel_time, ever_treat, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">|</span> i <span class="sc">+</span> t, <span class="at">data =</span> df)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>twfe1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y <span class="sc">~</span> lag_y <span class="sc">+</span> <span class="fu">i</span>(rel_time, ever_treat, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">|</span> i <span class="sc">+</span> t, <span class="at">data =</span> df)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>lpdid0 <span class="ot">&lt;-</span> <span class="fu">lpdid</span>(df, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>, <span class="at">outcome_lags =</span> <span class="dv">0</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                <span class="at">unit_index =</span> <span class="st">&quot;i&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;t&quot;</span>, <span class="at">treat_status =</span> <span class="st">&quot;treat_status&quot;</span>)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>lpdid1 <span class="ot">&lt;-</span> <span class="fu">lpdid</span>(df, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>, <span class="at">outcome_lags =</span> <span class="dv">1</span>,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>                <span class="at">unit_index =</span> <span class="st">&quot;i&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;t&quot;</span>, <span class="at">treat_status =</span> <span class="st">&quot;treat_status&quot;</span>)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, .<span class="dv">1</span>, <span class="fl">4.1</span>))</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="fu">plot_lpdid</span>(lpdid0, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>, <span class="at">x.shift =</span> <span class="fl">0.1</span>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="fu">plot_lpdid</span>(lpdid1, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">x.shift =</span> <span class="fl">0.1</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="fu">iplot</span>(twfe0, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">x.shift =</span> <span class="sc">-</span><span class="fl">0.1</span>)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="fu">iplot</span>(twfe1, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">x.shift =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">aggregate</span>(df<span class="sc">$</span>beta[df<span class="sc">$</span>ever_treat <span class="sc">==</span> <span class="dv">1</span>], <span class="fu">list</span>(df<span class="sc">$</span>rel_time[df<span class="sc">$</span>ever_treat <span class="sc">==</span> <span class="dv">1</span>]), mean))</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;True Beta&quot;</span>, <span class="st">&quot;TWFE&quot;</span>, <span class="st">&quot;TWFE + Y_lag&quot;</span>, <span class="st">&quot;LP-DiD&quot;</span>, <span class="st">&quot;LP-DiD + Y_lag&quot;</span>),</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">19</span>),</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;gray&quot;</span>, <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<!-- ## The ```castle``` Dataset -->
<!-- ```{r, fig.width=7, fig.height=5, fig.align='center', cache=TRUE} -->
<!-- library("fixest") -->
<!-- df <- bacondecomp::castle -->
<!-- df$t <- df$year - df$treatment_date -->
<!-- ifelse(is.na(df$t), -1, df$t) -> df$t -->
<!-- df$treat <- ave(df$post, df$state, FUN = max) -->
<!-- twfe1 <- feols(l_homicide ~ i(t, treat, -1) | state + year, data = df) -->
<!-- df$treatment_date1 <- ifelse(is.na(df$treatment_date), 3000, df$treatment_date) -->
<!-- sunab1 <- feols(l_homicide ~ sunab(treatment_date1, year) -->
<!--                | state + year, data = df) -->
<!-- lpdid(df = df, -->
<!--       window = c(-19, 10), -->
<!--       y = "l_homicide", -->
<!--       unit_index = "state", -->
<!--       time_index = "year", -->
<!--       rel_time = "t") -> reg -->
<!-- par(mfrow = c(1,1)) -->
<!-- plot_lpdid(reg, col = "tomato") -->
<!-- iplot(sunab1, add = TRUE, col = "dodgerblue", x.shift = 0.15) -->
<!-- iplot(twfe1, add = TRUE, col = "black", x.shift = -0.15) -->
<!-- legend("bottomright", c("TWFE", "LP-DiD", "Sun & Abraham"), -->
<!--        col = c("black", "tomato", "dodgerblue"), pch = 15, -->
<!--        bty = "n") -->
<!-- ``` -->
</div>
<div id="andrew-bakers-simulated-dataset" class="section level2">
<h2>Andrew Baker’s Simulated Dataset</h2>
<p>Andrew Baker created a simulated data (found <a href="https://github.com/scunning1975/mixtape/">here</a>) in order to
demonstrate the potential pit falls of using TWFE in a setting with
staggered treatment timing and temporal treatment dynamics. Below is an
aggregated version of this data where average outcomes are calculated by
time and treatment group.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>baker <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">&#39;https://github.com/scunning1975/mixtape/raw/master/baker.dta&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>baker<span class="sc">$</span>treated <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(baker<span class="sc">$</span>treat_date <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>baker<span class="sc">$</span>treat_status <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(baker<span class="sc">$</span>treat_date <span class="sc">==</span> baker<span class="sc">$</span>year, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="fu">list</span>(<span class="at">y =</span> baker<span class="sc">$</span>y),</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">year =</span> baker<span class="sc">$</span>year,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>                      <span class="at">group =</span> baker<span class="sc">$</span>group),</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                 mean)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, .<span class="dv">1</span>, <span class="fl">4.1</span>))</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="fu">plot</span>(tmp<span class="sc">$</span>year, tmp<span class="sc">$</span>y, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>     <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(tmp<span class="sc">$</span>group, .<span class="dv">4</span>),</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Outcome&quot;</span>)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="fu">lines</span>(tmp<span class="sc">$</span>year[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">1</span>]],</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>      tmp<span class="sc">$</span>y[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">1</span>]],</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>      <span class="at">col =</span> tmp<span class="sc">$</span>group[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">1</span>]])</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="fu">lines</span>(tmp<span class="sc">$</span>year[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">2</span>]],</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>      tmp<span class="sc">$</span>y[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">2</span>]],</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>      <span class="at">col =</span> tmp<span class="sc">$</span>group[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">2</span>]])</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="fu">lines</span>(tmp<span class="sc">$</span>year[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">3</span>]],</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>      tmp<span class="sc">$</span>y[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">3</span>]],</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>      <span class="at">col =</span> tmp<span class="sc">$</span>group[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">3</span>]])</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="fu">lines</span>(tmp<span class="sc">$</span>year[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">4</span>]],</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>      tmp<span class="sc">$</span>y[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">4</span>]],</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>      <span class="at">col =</span> tmp<span class="sc">$</span>group[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">4</span>]])</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">unique</span>(baker<span class="sc">$</span>treat_date)<span class="sc">-</span><span class="fl">0.5</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>When estimating a simple TWFE model, the following is the estimate
generated by OLS:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">feols</span>(y <span class="sc">~</span> treat <span class="sc">|</span> id <span class="sc">+</span> year, <span class="at">data =</span> baker)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; OLS estimation, Dep. Var.: y</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; Observations: 30,000 </span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; Fixed-effects: id: 1,000,  year: 30</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; Standard-errors: Clustered (id) </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; treat -6.69019   0.670213 -9.98218 &lt; 2.2e-16 ***</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; RMSE: 29.1     Adj. R2: 0.803436</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt;              Within R2: 0.003954</span></span></code></pre></div>
<p>Of course, the treatment effect is surely non-negative. Below, we
estimate TWFE, Sun &amp; Abraham, and LP-DiD models. Here, just to
exemplify another feature of the package, one can re-weight the
regression to obtain an ATT rather than a VWATT. Here, the results are
nearly identical to the estimates via Sun &amp; Abraham. Also, note that
the window (<code>(-20, 20)</code>) is wider than what is plotted
<code>(-17, 17)</code>. This is a feature since the FEs and the
treatment variable are perfectly colinear outside what is returned.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>res_naive <span class="ot">=</span> <span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">i</span>(time_til, treated, <span class="at">ref =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">|</span> </span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                    id <span class="sc">+</span> year,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                  baker, <span class="at">cluster =</span> <span class="sc">~</span>state)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>res_cohort <span class="ot">=</span> <span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">sunab</span>(treat_date, year) <span class="sc">|</span> id <span class="sc">+</span> year, </span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                   baker[baker<span class="sc">$</span>year<span class="sc">&lt;</span><span class="dv">2004</span>,],</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>                   <span class="at">cluster =</span> <span class="sc">~</span>state)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="fu">lpdid</span>(<span class="at">df =</span> baker, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>      <span class="at">unit_index =</span> <span class="st">&quot;id&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>      <span class="at">treat_status =</span> <span class="st">&quot;treat_status&quot;</span>, <span class="at">reweight =</span> <span class="cn">TRUE</span>) <span class="ot">-&gt;</span> reg</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, .<span class="dv">1</span>, <span class="fl">4.1</span>))</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="fu">iplot</span>(res_naive, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">grid =</span> F,</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Time to Treatment&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="fu">iplot</span>(res_cohort, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="fu">plot_lpdid</span>(reg, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>),</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;TWFE&quot;</span>, <span class="st">&quot;Sun &amp; Abraham&quot;</span>, <span class="st">&quot;LP-DiD&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>It is also possible to pool together the treatment effects and get
standard errors using the <code>lpdid</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">lpdid</span>(<span class="at">df =</span> baker, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>      <span class="at">unit_index =</span> <span class="st">&quot;id&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>      <span class="at">treat_status =</span> <span class="st">&quot;treat_status&quot;</span>, <span class="at">reweight =</span> <span class="cn">TRUE</span>, <span class="at">pooled =</span> <span class="cn">TRUE</span>) <span class="ot">-&gt;</span> reg</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>reg<span class="sc">$</span>coeftable</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt;    Estimate Std. Error  t value Pr(&gt;|t|)</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; 21 90.09827  0.6896807 130.6377        0</span></span></code></pre></div>
</div>
<div id="non-absorbing-treatment" class="section level2">
<h2>Non-Absorbing Treatment</h2>
<p>A final feature of the package (that is still under construction), is
handling non-absorbing treatment. The treatment example used in Dube et
al. (2023) is changes in the minimum wage. It is impossible to find a
“clean control” since all states have increased the minimum wage at one
point or another. So, the authors (see also <a href="https://doi.org/10.1093/qje/qjz014">Cengiz et al., 2019</a>) make
an assumption that <span class="math inline">\(L\)</span> time periods
after treatment, the effect “stabilizes”. See the text for more
details.</p>
<p>Below, we simulate data where there are three groups. First, there is
an untreated group. Second, there is a group that gets treated only a
single time. Finally, there is a group that is treated twice. The effect
sizes are 15 and 35 for first and second treatments. The aggregated time
series plots can be seen below.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">757</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">50</span>; bigT <span class="ot">&lt;-</span> <span class="dv">50</span>; N <span class="ot">&lt;-</span> I <span class="sc">*</span> bigT; e_var <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>I, <span class="at">each =</span> bigT),</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>           <span class="at">t =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>bigT, I),</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>           <span class="at">e =</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, e_var)) <span class="ot">-&gt;</span> df</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>unit_FE <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(I, <span class="dv">0</span>, e_var)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>time_FE <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(bigT, <span class="dv">0</span>, e_var)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>df<span class="sc">$</span>treated <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">21</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>df<span class="sc">$</span>treat_status <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">21</span> <span class="sc">&amp;</span> df<span class="sc">$</span>t <span class="sc">==</span> <span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>df<span class="sc">$</span>treat_status <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">11</span> <span class="sc">&amp;</span> df<span class="sc">$</span>t <span class="sc">==</span> <span class="dv">36</span>, <span class="dv">1</span>, df<span class="sc">$</span>treat_status)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">11</span>,</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>       <span class="fu">ifelse</span>(df<span class="sc">$</span>t <span class="sc">&gt;</span> <span class="dv">35</span>, <span class="dv">50</span>,</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>              <span class="fu">ifelse</span>(df<span class="sc">$</span>t <span class="sc">&gt;</span> <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">0</span>)),</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>       <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">21</span>,</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>              <span class="fu">ifelse</span>(df<span class="sc">$</span>t <span class="sc">&gt;</span> <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">0</span>),</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>              <span class="dv">0</span>)) <span class="ot">-&gt;</span> df<span class="sc">$</span>beta</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>df<span class="sc">$</span>y <span class="ot">&lt;-</span> df<span class="sc">$</span>e <span class="sc">+</span> unit_FE[df<span class="sc">$</span>id] <span class="sc">+</span> time_FE[df<span class="sc">$</span>t] <span class="sc">+</span> df<span class="sc">$</span>beta</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">11</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">21</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(df<span class="sc">$</span>y, <span class="fu">list</span>(df<span class="sc">$</span>t, df<span class="sc">$</span>group), mean)</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, .<span class="dv">1</span>, <span class="fl">4.1</span>))</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="fu">plot</span>(agg<span class="sc">$</span>Group<span class="fl">.1</span>, agg<span class="sc">$</span>x, <span class="at">col =</span> agg<span class="sc">$</span>Group<span class="fl">.2</span> <span class="sc">+</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Outcome&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Notice the difference in this function call versus the previous ones.
First, there is no <code>rel_time</code> argument needed. This is
because the function will generate <code>rel_time</code> by itself.
However, you must include <code>nonabsorbing = TRUE</code> in addition
to a <code>nonabsorbing_lag</code> and
<code>nonabsorbing_treat_status</code>. <code>nonabsorbing_lag</code>
represents the number of periods until the dynamic treatment effects
stabilize. Then, <code>nonabsorbing_treat_status</code> takes on values
of <code>1</code> each time a unit gets treated.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">lpdid</span>(<span class="at">df =</span> df, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">12</span>, <span class="dv">12</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>      <span class="at">unit_index =</span> <span class="st">&quot;id&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>      <span class="at">nonabsorbing_lag =</span> <span class="dv">5</span>,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>      <span class="at">treat_status =</span> <span class="st">&quot;treat_status&quot;</span>) <span class="ot">-&gt;</span> reg1</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">lpdid</span>(<span class="at">df =</span> df, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">12</span>, <span class="dv">12</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>      <span class="at">unit_index =</span> <span class="st">&quot;id&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>      <span class="at">nonabsorbing_lag =</span> <span class="dv">5</span>,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>      <span class="at">treat_status =</span> <span class="st">&quot;treat_status&quot;</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>      <span class="at">reweight =</span> <span class="cn">TRUE</span>) <span class="ot">-&gt;</span> reg2</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, .<span class="dv">1</span>, <span class="fl">4.1</span>))</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="fu">plot_lpdid</span>(reg1, <span class="at">x.shift =</span> <span class="sc">-</span><span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="fu">plot_lpdid</span>(reg2, <span class="at">x.shift =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>, <span class="at">add =</span> T)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(<span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">35</span>)), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;VWATT&quot;</span>, <span class="st">&quot;EWATT&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;tomato&quot;</span>), <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="under-construction" class="section level2">
<h2>Under Construction</h2>
<p>This is the first iteration of this package. So, of course, there are
some known (and surely many unknown) bugs. Some of them are as
follows:</p>
<ul>
<li>Reweighting does not currently work as intended for the
non-absorbing estimation. This, as well as other portions of the
non-absorbing estimation, are still being worked on. <strong>This has
been fixed in Version 0.3.0.</strong></li>
<li>Pooling the effect across post-periods does not always work as
intended when using controls or outcome lags as regressors. <strong>This
has been fixed in Version 0.2.0.</strong></li>
<li><strong>Version 0.4.0</strong> has been updated to:
<ul>
<li>Fix a bug that caused too-large p-values when effects were
negative</li>
<li>Change the way controls are input into the function. Now, you should
use <em>formulas</em> instead of character vectors to supply controls.
In addition, controls can be time invariant or time varying.</li>
<li>Allow the user to specify the level of clustering.</li>
</ul></li>
<li><strong>Version 0.5.0</strong> has been updated to:
<ul>
<li>Add in support for FEs.</li>
<li>Change the requirement for “rel_time” to “treat_status”.</li>
</ul></li>
</ul>
<p>Please direct any questions or comments to <a href="mailto:alex.cardazzi@gmail.com">Alex</a> and all complaints to <a href="mailto:zachary.porreca@unibocconi.it">Zach</a>.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>This function is under development. Currently, the
parameters are fixed, so the only options are the exogeneity of the
treatment timing and the random number seed. The intention is to allow
for full control over the parameters so users can experiment.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
