<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Alexander Cardazzi" />

<meta name="date" content="2023-06-21" />

<title>Local Projections Difference-in-Differences</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Local Projections
Difference-in-Differences</h1>
<h4 class="author">Alexander Cardazzi</h4>
<h4 class="date">2023-06-21</h4>



<div id="getting-started" class="section level2">
<h2>Getting Started</h2>
<p>Please see the working paper on which this package is based <a href="https://www.nber.org/papers/w31184">here</a>.</p>
<p>To install and load this package, use the following code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="st">&quot;devtools&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) <span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="st">&quot;lpdid&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;alexCardazzi/lpdid&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lpdid&quot;</span>)</span></code></pre></div>
</div>
<div id="a-simple-2x2-did-example" class="section level2">
<h2>A Simple 2x2 DiD Example</h2>
<p>To begin, consider a simple 2x2 DiD where treatment begins at <span class="math inline">\(t = 31\)</span>. Only twenty out of fifty units
get treated, and the treatment dynamics cause the outcome variable to
increase linearly with time. Below, the outcome is averaged by time and
whether the unit receives treatment at some point.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">757</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">50</span>; T <span class="ot">&lt;-</span> <span class="dv">50</span>; N <span class="ot">&lt;-</span> I <span class="sc">*</span> T</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>I, <span class="at">each =</span> T),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">t =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>T, I),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">e =</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">4</span>)) <span class="ot">-&gt;</span> df</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>unit_FE <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(I, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>time_FE <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(T, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treated <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">21</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>time_til <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>treated <span class="sc">==</span> <span class="dv">1</span>, df<span class="sc">$</span>t <span class="sc">-</span> <span class="dv">30</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>y <span class="ot">&lt;-</span> df<span class="sc">$</span>e <span class="sc">+</span> unit_FE[df<span class="sc">$</span>id] <span class="sc">+</span> time_FE[df<span class="sc">$</span>t] <span class="sc">+</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">21</span> <span class="sc">&amp;</span> df<span class="sc">$</span>t <span class="sc">&gt;</span> <span class="dv">30</span>, df<span class="sc">$</span>t <span class="sc">-</span> <span class="dv">30</span>, <span class="dv">0</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(df<span class="sc">$</span>y, <span class="fu">list</span>(df<span class="sc">$</span>t, df<span class="sc">$</span>treated), mean) <span class="ot">-&gt;</span> tmp</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tmp<span class="sc">$</span>Group<span class="fl">.1</span>, tmp<span class="sc">$</span>x, <span class="at">col =</span> tmp<span class="sc">$</span>Group<span class="fl">.2</span> <span class="sc">+</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Outcome&quot;</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Treated&quot;</span>, <span class="st">&quot;Control&quot;</span>),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In the most simple of cases, LP-DiD and TWFE preform very similarly.
Of course, TWFE is not biased in this setting, so we observe nearly
identical parameter estimates (and standard errors). The important
arguments for <code>lpdid()</code> are the following:</p>
<ul>
<li><code>df</code>: The analysis dataset.</li>
<li><code>window</code>: This is the pre- and post-period lengths in
terms of time. Importantly, the first value must be negative and the
second must be positive.</li>
<li><code>y</code>: The name of the outcome variable.</li>
<li><code>unit_index</code>, <code>time_index</code>: unit and time
indices. For example, if the data is state-by-year, this is where you
would input these names.</li>
<li><code>rel_time</code>: This is the relative time variable.
<strong>For untreated units, this must be negative.</strong></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lpdid</span>(df, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">unit_index =</span> <span class="st">&quot;id&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">rel_time =</span> <span class="st">&quot;time_til&quot;</span>) <span class="ot">-&gt;</span> reg</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">i</span>(time_til, treated, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">|</span> id <span class="sc">+</span> t, <span class="at">data =</span> df) <span class="ot">-&gt;</span> twfe</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lpdid</span>(reg, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">iplot</span>(twfe, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;TWFE&quot;</span>, <span class="st">&quot;LP-DiD&quot;</span>),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;tomato&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">19</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="staggered-exogenous-treatment-timing" class="section level2">
<h2>Staggered (Exogenous) Treatment Timing</h2>
<p>If you are reading this, it is likely that you are aware that TWFE
estimates are potentially biased depending on treatment timing and
dynamics. In Dube et al. (2023), the authors simulate two sets of data:
one where treatment timing is exogenous and the other where it is
endogenous. First, LP-DiD is applied to the data where treatment is
exogenous.</p>
<p><code>lpdid</code> has a built-in function to replicate (as closely
as possible) the simulations in Dube et al. (2023).<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Using this, we
estimate TWFE and LP-DiD models in addition to plotting the “true”
average beta values.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">genr_sim_data</span>(<span class="at">exogenous_timing =</span> <span class="cn">TRUE</span>, <span class="dv">789</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>twfe1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">i</span>(rel_time, ever_treat, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">|</span> i <span class="sc">+</span> t, <span class="at">data =</span> df)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>lpdid1 <span class="ot">&lt;-</span> <span class="fu">lpdid</span>(df, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">unit_index =</span> <span class="st">&quot;i&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">rel_time =</span> <span class="st">&quot;rel_time&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lpdid</span>(lpdid1, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>, <span class="at">x.shift =</span> <span class="fl">0.1</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">iplot</span>(twfe1, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">x.shift =</span> <span class="sc">-</span><span class="fl">0.1</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">aggregate</span>(df<span class="sc">$</span>beta[df<span class="sc">$</span>ever_treat <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(df<span class="sc">$</span>rel_time[df<span class="sc">$</span>ever_treat <span class="sc">==</span> <span class="dv">1</span>]), mean))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;True Beta&quot;</span>, <span class="st">&quot;TWFE&quot;</span>, <span class="st">&quot;LP-DiD&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>, <span class="dv">19</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;tomato&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAe1BMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmAGZmOgBmZgBmZmZmtrZmtv+QOgCQOjqQZgCQkGaQtpCQ2/+2ZgC225C2/7a2///bkDrb25Db/9vb////Y0f/tmb/25D//7b//9v///9hsOHxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAZuElEQVR4nO2di1rcOpZGnTQDfXogM91d9JyJz4lnoCjq/Z+wLcm3omxJ1vWX/K/vSwiFKW/MiizJ0t7NlRBgmtwBEKKDghJoKCiBhoISaCgogYaCEmgoKIGGghJoKCiBhoISaCgogYaCEmgoKIGGghJoKCiBhoISaCgogYaCEmgoKIGGghJoKCiBhoISaCgogYaCEmgoKIGGghJoKCiBhoISaCgogYaCEmgoKIGGghJoKCiBhoISaCgogYaCEmgoKIGGghJoKCiBhoISaCgogYaCEmgoKIGGghJoKCiBhoISaCgogYaCEmgoKIGGghJoKCiBhoISaCgogYaCEmgoKIGGghJolKCXl2bi+6/MIREywxaUQENBCTSzoONtnrd4AsQsaPvw1j1eP55OGaMh5AuToJeX5+v54e3a9X8IQWEh6On68dsv+YcQFCZBP1+fr5cfPykogWLug3b96Kh95i2eQLGYZmofxUieg3iCBOdBCTQUlECzGMU/5oyDkFUWE/VN03z7mTEUQu65ucWfxaNONqQEiK990M9XDuMJEGxBCTSLJ0nsgxI8OIon0Nw8iycEjZvVTISgMQ+SziGG7w0hVuwWdNrY6eUpn5wSK/YLmvi85NiEFVQtYpYTUXIkdd6ckKKgxAoXQfub/MNbuzKWv7yI2/7nay9lJ+bxz/0/zuuGQgsKHdzBcBC0V657eBN7575wVv1Std+z+/5LTUi1q9Om0A5AB3cw9gsqtBPbPbqvg6Rz87wY4PcaT6b6nDcH0MEdDJdR/EkKujbbtHit/f7r468/r1uzUtAOQAd3MNxb0HZl09wsY9+cDt3Pm07o/umtHEAHdzCc+6Bds/JAaRL0PI6RrhujJDpArHAcxW9MH42CnuUsU7G3eIJD2HnQQcZOzYIWO0gi2Xj/+oLDIOmHaju3B0nj3Z/TTGQvAQVdaxnPah50nCHlRD3Zibeg7TwOX3mUJAXt1JeFmF2Zjzqhg6ubgC2oH7rzWq2Xaqf/BTPnQCtVKWg2Aggahtu3u58XVTMAGtQ0bLc0NNhSagqajRCCysVKQdeDNveBWAp6syKAa/3LJ4SgbZAV9Xf/vo1ECXr58Xvz/U/hnZSvW/R8R0HlTJZ8/eOpacQTrv4TiloqIfqg98uYHLAU9KU37jIKKu7n0xTBcIsXc1jj6/JAMavVcVd0qQQRNET7ZCvo83USVP3PGKdfh+kEKfDwujhQDuF8CzywD5qNAIJ+vobYF2/XB50aT/GXmlEd5VMtqHjmP70+/tc5+97jKWg2QvRBzyG6eHaj+FtBh8mnpaCiQzy9PvZTv//BFrRQ3t+/Goq6q3OzBR0ZBO16QcfXZf0R4SZv8YXy/n5nKMY86D03gj7f3MEVYwsqNp8Mr4t/yC6qbxtPQfPw/n5vaAGCfr4+vH2+NmoUf22H9nLsg56u0+vCZNF49m08s/OUSKGCyk7FP8d50LFjsXzUOb7eNmIhdf9iy3mmEgkgaLB68byLknsK6oNmBTq4qgkxig8DtAPQwdUN6GomMKCDqxsKagN0cPUiHtdQUBugg6sW+cCbghJQ1pYMrb2g/37JZna73eGsMz9M/btaUyfn3cUilXFH1Gn6F2uC10I4QTez2+0PZxs1Ua92jrb/EBqKE87pdtYS75CSCSboZnY7h3CmzzZWM8lVH5cf/ys+Ea8kEpT9jxyE6oPqstvti2b+5D6b2GLB8vnh/19PqjWloDUTaBSvy263I5jbwO4MHTbNyQ0cj/KD/ENBKyfIguXt7Hb2WAp6FguZTuOHpaDb2SP8oaA4OI7ivat1WgrafxC7jPoP8oV2WlPPFvQgQMyDbvZB+/7EqW89xw8cxR8PCEE1mUXaZ7mzuH1UHyjo0XARVMhx9uz92c2D9p3Q/xB9z+v5L/99ulLQA+KSWWTI6eG1+9hW0I+/DROiss/LUfzhcE/cEHAedIVRULEhaf5wP4qPsreDguLgNg8qCPkkCQzo4A6Gwy1ezYDOeZTjnjcH0MGVzN00vBmXQZJIIxdyHhQO6OBKJpGg26hqx3ORY1Y7JktyC6qqHc+1E0otokAikUbQzQzLQ7XjqfpMsWVoSCTSCLqVYXmsdjzV7yq2kBd0cCWTRFDdUnol6FgBcaUU4pyXRHuyab5zmO6cGuF5tciQT3mZkTEYFDQSiQTd1kHllhtryLoXk50FHZ5a3X7+8fR4Xf88DBQ0EkkE1WVYdhX0a8aTL4LO72H6PAwUNBJp+qCa7JvGW/z6ee9yRn0VdMpIO3wu/pOoW/z8eUAoaCQS3eK3s9u5DZLus+6ZWtApb+3ic9sfhGTjPjWYmbAT9WenaSajoPPKqfELnarpsfzc9gchuVhJrmgmgqC7J+p1gn7ZeURBy2UtPa2ZsJlFhv5mt0h9bPOo09gHvftC3Fs8+6AxSCZohMwiplH8dSx3yEFSuegE3Z4bx8gs8hVTCyr6DUtBOc1UAtoGdOuaQ2QWucMgqFyLuhDUc23qzuCIK7obfDhBw2cWuWcaG90JykedJaPpgIYTNHxmEXIU0ggaPLMIOQqJBA0BBT0iFDQM0MGVTHxBj1FpDjq4kkk0SJJPHj2nHqEdgA6uVFbT0y6+vPP17QPHpzZdxGmmzEAHVyjimt4n+J6/vLXHAjX1TVaggyuTZvH32pc3dwG5p76JOVFPaiOhoMOK+q7iPigJTkpB1VDec30bBT0YzVX7Sw/YBw0DtKDQwZWKYas5J+p3AB1cpVDQHUAHVynBniQ963Z1+scDAXRwlcIWdAfQwVVKsBb0JAprxYuHHJSAt3gKSsIT6hbfHWE1E0lPwE1z9beg0MFVSchtx2GAdgA6uIPhIOhmCvAo580BdHAHw0HQrRTgcc6bA+jgDobLetAQWRKgHYAO7mC4L1hOdF5ybNy3fCQ6LykGh/zJZpwXLKc6LykGEEG5WISsAyJo4vPmADo4XChoKqCDwwVGUGM57m7MiFhotWPo4HBBEVRlFtGkXxQbPuVIqtRqx9DB4QIi6LgvfjOziJqHYrXjw7ElqE111k0iZBaZBC222jFxwiHzkpkILeh0i3evdkxKBERQcx90HBu5VzvODHRwsLiUSDATYxQvljuJwhsU9Eg4FZkxE2EedC4ma1vtGA3o4EDR15GDEnRqOIsdJEEHBwqMoGqMriudpbzsG85ip5mggwMFRdDLixq8jx/XGPugxU7UEwdA+qBT2lrdwvp2rKBtWe2YlI5MQK/x031acaeg4yToteoc9WQnjfyj89PZ0P2pb8YXmKOeDKjrtV0iIamgcwtKQYkCSNDFmLziIgrQwQFiEjRhH3SYQ1r+I/J5cwAdHCKGPmjSedDzOD732x0P7QB0cJDIJhJD0CHzje/WYzpQHyCChoGC1gcFJdBQ0FRAB1ckFDQo0MEVCQUNCnRwRUJBgwIdXHkk3tUpEJs+/KrJQjsAHdzBcBJU1lE41/uok+DgJOjHf/ZuXv6r2sUiBAen5XZsQUkqdregrdgPL/qgfqUUoAWFDu5gONziW891IvvOmwPo4A6GUx+0814rgu0AdHC5iJK7zsz+XZ1yH9zZc5YJ2wHo4HJRhqCfr6IH+tsv0Q3llo9DUYagcm7p81/+5WTpQGmUIejcgqY6LwGhDEHlenpdevrg5yUgFCJo8vPmADq4XFBQHKCDy0UZgqrEDWffOnPgDkAHl4uCBJVZmTyLHkM7AB1cLsoRdFCz4uRh0MFlYjN3XeSiGA6CDjlFKk4eRu6IlP3TDFtQYqRvICPlT7Y4974DVS3ux6s+gW3I85LsiKw2TSGCXqWjcrUIczMdBHE13pWhmiNinj3sgVe1nlkuyGO14wqQV0MKqj0i5tmDHqg2g1xeHsstogAdXHLU1Wii1JGzPfuOA1Vyu0ZTCFHlse9YhqYWGvknSuYlu5PvOVBWjxPZv9vNWSZVYO56LbfaMXRwGYiX/dPi3PsOHKp8tM9bLeNVTJD++SLL0LDacU1ESfBtxmnbsZwD3Zyo78RzelGQrthismSFKCUSzDi2oI+aKh/dt6HhpKA1UYagyj5x75bD9FWUuX0HlNWOa6IQQeVSu286Pwcjezs5SKqJMvqgNqh+KqsdV0YZo3grxBBKysmJ+oqoSFDZDSi52jF0cLmoSdD0b0c88VovT0FJbCho3LcjntQiqFqwrKh3ywd0cHGoRVCBWqu8MToPft4cQAcXh4oEFU/ZBRXvSYIOLg7ugmLt6rzOG+Ir3tUJHVwcMu16N+PSgqrdSC1b0IqoSNC+DyofsVfcBz0gNQmqhvI1pwA/IFUJmvS8JAWaLZuZoaArQAcXA21im7w4CDru6+QovhbetYlt8uIg6PZ+zhjnzQF0cBGoS1DPpEx7z5sD6OCCY0oNlhf3ifpE580BdHChkWkZNv3Mvknc/VFnovOSuORNbGPGeaI+1XlJXEZBTUfkwuUWX/1yuyNRn6CJz5sD6OBCI/uguXYcmaGgK0AHF5ycqcHMOAg63uPrvcVDBxeHmgRtH966x7HWR/Tz5gA6uDhUJKiYqBc5lLmiviaqEvQkC3L7FeU+oAPQVCSoWFF/+fGTglZFptRgZhz6oDIB+HPNt/jasHjKnim5ohmXaab2UYzk/dY0QQsKHZwDPstAShQ06XlzAB2cAxQ04nlzAB2cA35ZGYrrg6Y9bw6gg3PAb6VnaaP4xOfNAXRwDlDQiOcl/lDQe1TekUKLydbG0QS9vDQPb612Z9JZJnYoNUd9bRxM0F657uFNu3dOKnxllQ8QjiWo0E48RdqsNHcVqRn/pz+CdZIw8NywWZqgYrGItlanLOIl+qCsNAeB75bi0gQdW9Dt9IviCPHVlVqdZVQ7hg5uL35ZGbL/tpz7oN323s5R32KLyUIHtxfktCEWOI7iN6ePrkOZ+KJv8TUx5g3JHYcrEeZBu+G2cCp2kFQRYj9cs+ln9hu4GYdB0g/Vdupz1LclTzPVg7zM77i73s24C6qbZhqeJJU6UQ8d3C6axd+6I3DZK2g7j8O1j5LUGJ/FZBOg614eT9C5BU103hxAB3eHdvwj84aYFcaFq5lWgA7uDv0AXYyBDiYoM4tgYZ5BOpig9WcWKQsKenvgATKLlAUFvT2QmUXA8BIUfJqemUVWgQ7uDh9B4R8kMbPIGtDB3VHyrnczzCyyAnRwX/FaCFKnoEnPmwPo4L7guVQJ3U8KugZ0cLd4r/ZE/1k5UV82FPTuwM9Xz1Lx+85LtFDQuwMPUAqxJMreEmfGbR404XlzAB3cV4reVGzGoQ+qthqlOm8OoIO7o+S0DGZcBH2qfZCEFJzfk3YzSD/rGi63+OqrHSMF5yGo1Y44pJ91DQ6SVkAKLupy5Cp3dR5gkIRE3Rs6zHCQBE7dW+LMuNziWS8+IRQ09IFZ3i4sSMFR0NAHZnm7sCAFxz5o6AOzvF1YkIIzj+K1Xw8ZShZ2Cnp5eT5AHxQpuLqn4c2wBV0BKDjPlSDYc5w2OIzirbLbBTvvsfFbqwQ/C2+Bu6D67HbBzntoPFd7HlFQ2+x2wc57aHSCWjylPKKgzG6XEn0Lag6zfD85SFoDJzjtHd4iTJyfxBWnTXPPIjOt384k6CsHFJyuB0pB1w9sH94+nh43cs8HP28OkILzSy+P9JO44bYe9NycNNNMn6/jEKrQasdIwVHQvQcKQdtezs1pps/XXsqueSy3iAISFHT3ge3j5UVUO966xU/lkViGxohf6kTz+5d/mZ0GSf1927gzqW85WcjLiNeGDgrqdOBA3wsothRiuuCMG940i+lsJjmhL7MVsQQ996MkVjs2os19rD5sf93qQRL0hbZg93K7aUundrHIeRwjsdqxlqiCVoGLoGrwoxP0LGeZeIs3QkFNRBG0U7OgxQ6SMARVGzo0BxzBzyiCdo3qB3CayYh+jG5Q8BDXMIKgH0/jQjxO1JvwmkQ6xDWMIGinRo9CzEKrHSfDbynIIa5hnEFSwPPmIFVwnovpoK9hKEAExZqySxSIdjmyxeWAuV4x2S3oPNUetgVFutoAgtaQOTEIMCvqka42BcWBgq4A0AeloAMUNCe6MRL7oBIKmhWPeVCscWU0KGg2/Fd7HgGHLR9xUt8g/T6SxCKftFNQE+6CBk594//7CHfPi+3GvCRWtxYkchCFsFfQWKlvwqgV6JeawA3TYjoKOuDeggY9b6DGj4JWB8gg6XiCsg9qh4OgMi9D4EedgTbYgP1Szas9KagJB0FbLzM3zhtmXhrsl8rVnv449EFfolSaC/IbA/ulchreHxdBo9TqRBI0lBi8gfuzX9BI1Y4DCupXGMPuTFZQUH8c+qDnJkATGkXQ4aZYgKC8fdvicouPuWDZp9EZu234grKDaQ3IPGh1gspIKKg/FDQKahZ+u/wBBbXFRdD+Jv/w1vpNNu0X1GamNFAf1BsVht7QhOGUjMsg6dvPTiSwDblYpDG2flaNjmEUP08uRnZY/iRSUPcSMkTiMs30fO0FjVRpziyoufq0RX1qQ+JY7VctoKDBcJuoF4LGSdxQh6DiHZSfFNQT9xa09SqUtFvQqdtm1E9b3DKgoNoRUI9vES4icO6Ddn7T9fsFtXFL3VotMh7FFHR6A88iXETgOIrfTArmeV5PtxpjeUuLZjiYoHzUGQCYeVCJzV3RR9BprsCjCPvwPhQ0DVCCWhX3NUwi2QjqVYR9iMRmsbGhl+oRwXGoSNDlm2y9hfRCfxozKhCL7Rr5nxiUz05BLy/PkRaLCIIIqu/HNsZu6lZwX7/c+A7FiA1QLahNH9Si6bMa5/sKqnuQSUHDEVfQ3dWOjaN4m5uzzUyp9k1MP6vtNDwF9cdFUDFFf7bJ2+BQRMFnCGR8j6tlM6y7KDfT8IbsyBTUHwdB1SOk7WrHE3vL0Bj24aojTHdnw3s0ximi4T0MTblv8lliiduzeIH5WfzOQl5qDaU+Bv0KDIv3aExTRMot7VlM3QQKGhC3Z/EC82qmfaUQG2M80xohQ5Cb7zFNP247PE5EmVcicTlyEhxu8eop/FyuaxNtteNRlaAfG9vj3vVfF4Ia3+d98+vRfr4jfjRZNqk1//PjqbF6Fr+v2rFdCxroCONYTNOCNuYhENvPYMScZtpZ7dimDxroCN3XVUNs0cOkoCmIKujOaseNzSje4gg9dkdY9DApaApiCupS7dg8dZhgclH7s1LQpOwUdN+z+CjVjnMLGigRH7EjZgsap9px/scz5tgpaDB2t6CnKCnAd0BBD4XDLZ6CGr7cTN1U4s3eW3zXTGSqF5+9D8r2MSX7+6C5W9AEUFAcyuuDJsAwkc8beELK64MmADq4g1FeHzQB0MEdDPZBCTRxJ+qTvR2pFRdBoySwJWQNB0FjJLDFAjq4g7Ff0LgJbCGADu5gOAySoiawhQA6uIPh3oLGSWALAXRwB8O5D+qbwJYQK/YLGiSBrekc4JQT6WFCTfFzlnMty4n0MKFS0CXlRHqYUB32xfucA5xyIj1MqItBkkxs5zlIMpwDnXIiPUyoN9NMgs5rmkl/DnjKifQwod5M1Av8Jur154CnnEgPEypb0CXlRHqYUNkHXVJOpIcJNcUonhBnCvqPSI4IBSXQjIJ+vopsdRb5lQlJySDo5UUN3sePhGAwCDqtAvXc8kFIWJSg4yToNco8KCHOTKlvxhciPEkixJkp9c34gt+mOULCMvZBp4zzfnuSCAnLIKiq3LH8ByEIjPOgQ5njzqbaMSHJWKxmEnvtjKWOCUlKgkedqsANvvrnYpbKlHJF+x7jb3LI7XFpEwiqSifCo6n+hEYhV1T8T5JzQj6XNoGgZcys6urnoVHGFZUNp4jU69ImELQr4peuq0CKRhlXVAy85X8lr0ubQND2b32HCX5yQFfDGY0yrqhACepzaeMLqhZIeSbGjY/qIxXRCS3kigqklV6XNtWCZfimqSBBFfBXVFCOoPBPqEq6xUvgr6gA/BbfzV0l+JmRkgZJEvgrKihhkKTCg2+aCppmKuSKCs4lTDPJyPC79AVN1BdyRa/j/yLwifpr29/pC+gvdcU86izlik7NvMel5bZjAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBSXQUFACDQUl0FBQAg0FJdBQUAINBTWjqr70fP/zRZsR6Xz71fn7tvLQnY0JlsxHVA4FtcMmG+dlRV/t9619w94jaoeC2kFBM0FB7VCiCV8+nv7Z37qfP55UBsQ5i7R45eFNFAdaVOAYvu/H7+I+Px2r0ifKb/i/1be7vIhXT8NbHhkKasdS0G8/e4+Eb+JP/8nHkxJSNnfn3rPLy+PX7xOaTceKBLTik+23u7yIV7/9ZAtKQe1YCvp8Hf86XV6Em0OaVvFVle56Tic8ft/z8Jc49vLjp8rjvf128h/yBQpKbFgKerpOfykTh4Ib01cXFTjm77veHHtumpPm7eQ39H9RUApqx5agw0TSF0Fnr5aCTsf2Hc3vfzytCToeQkFHKKgd2hZ0wKoFvc7frHk7CjpCQe3YEPRGIF0f9LRoVlX5tbVb/HQIBR2hoHZsCCqH3ddW+ShHNhujeDmFNByrGs/mWX7D+tvNgpZQbCYmFNSOLUHlxOX4KLPdnAdVDeF4rKzKIqxuxTzo2ttNTW7LeVBCgKGgBBoKSqChoAQaCkqgoaAEGgpKoKGgBBoKSqChoAQaCkqgoaAEGgpKoKGgBBoKSqChoAQaCkqgoaAEGgpKoKGgBBoKSqChoAQaCkqgoaAEmn8DpRc6BCj/g4oAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
</div>
<div id="staggered-endogenous-treatment-timing" class="section level2">
<h2>Staggered (Endogenous) Treatment Timing</h2>
<p>For endogenous treatment timing, the main idea is that treatment is
more likely following a large negative shock. See page 28 of the paper
for more details on this. However, given this, we can include a lag of
the outcome variable into the model. Below, four event studies are
plotted: TWFE and LP-DiD, both with and without a lag of the
outcome.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">genr_sim_data</span>(<span class="at">exogenous_timing =</span> <span class="cn">FALSE</span>, <span class="dv">789</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The returned &quot;df&quot; is a pdata.frame, so lag() works in a panel setting.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>lag_y <span class="ot">&lt;-</span> <span class="fu">lag</span>(df<span class="sc">$</span>y, <span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>twfe0 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">i</span>(rel_time, ever_treat, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">|</span> i <span class="sc">+</span> t, <span class="at">data =</span> df)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>twfe1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y <span class="sc">~</span> lag_y <span class="sc">+</span> <span class="fu">i</span>(rel_time, ever_treat, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">|</span> i <span class="sc">+</span> t, <span class="at">data =</span> df)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>lpdid0 <span class="ot">&lt;-</span> <span class="fu">lpdid</span>(df, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>, <span class="at">outcome_lags =</span> <span class="dv">0</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">unit_index =</span> <span class="st">&quot;i&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;t&quot;</span>, <span class="at">rel_time =</span> <span class="st">&quot;rel_time&quot;</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>lpdid1 <span class="ot">&lt;-</span> <span class="fu">lpdid</span>(df, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>, <span class="at">outcome_lags =</span> <span class="dv">1</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">unit_index =</span> <span class="st">&quot;i&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;t&quot;</span>, <span class="at">rel_time =</span> <span class="st">&quot;rel_time&quot;</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lpdid</span>(lpdid0, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>, <span class="at">x.shift =</span> <span class="fl">0.1</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lpdid</span>(lpdid1, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">x.shift =</span> <span class="fl">0.1</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">iplot</span>(twfe0, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">x.shift =</span> <span class="sc">-</span><span class="fl">0.1</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">iplot</span>(twfe1, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">x.shift =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">aggregate</span>(df<span class="sc">$</span>beta[df<span class="sc">$</span>ever_treat <span class="sc">==</span> <span class="dv">1</span>], <span class="fu">list</span>(df<span class="sc">$</span>rel_time[df<span class="sc">$</span>ever_treat <span class="sc">==</span> <span class="dv">1</span>]), mean))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;True Beta&quot;</span>, <span class="st">&quot;TWFE&quot;</span>, <span class="st">&quot;TWFE + Y_lag&quot;</span>, <span class="st">&quot;LP-DiD&quot;</span>, <span class="st">&quot;LP-DiD + Y_lag&quot;</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">19</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;gray&quot;</span>, <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<!-- ## The ```castle``` Dataset -->
<!-- ```{r, fig.width=7, fig.height=5, fig.align='center', cache=TRUE} -->
<!-- library("fixest") -->
<!-- df <- bacondecomp::castle -->
<!-- df$t <- df$year - df$treatment_date -->
<!-- ifelse(is.na(df$t), -1, df$t) -> df$t -->
<!-- df$treat <- ave(df$post, df$state, FUN = max) -->
<!-- twfe1 <- feols(l_homicide ~ i(t, treat, -1) | state + year, data = df) -->
<!-- df$treatment_date1 <- ifelse(is.na(df$treatment_date), 3000, df$treatment_date) -->
<!-- sunab1 <- feols(l_homicide ~ sunab(treatment_date1, year) -->
<!--                | state + year, data = df) -->
<!-- lpdid(df = df, -->
<!--       window = c(-19, 10), -->
<!--       y = "l_homicide", -->
<!--       unit_index = "state", -->
<!--       time_index = "year", -->
<!--       rel_time = "t") -> reg -->
<!-- par(mfrow = c(1,1)) -->
<!-- plot_lpdid(reg, col = "tomato") -->
<!-- iplot(sunab1, add = TRUE, col = "dodgerblue", x.shift = 0.15) -->
<!-- iplot(twfe1, add = TRUE, col = "black", x.shift = -0.15) -->
<!-- legend("bottomright", c("TWFE", "LP-DiD", "Sun & Abraham"), -->
<!--        col = c("black", "tomato", "dodgerblue"), pch = 15, -->
<!--        bty = "n") -->
<!-- ``` -->
</div>
<div id="andrew-bakers-simulated-dataset" class="section level2">
<h2>Andrew Baker’s Simulated Dataset</h2>
<p>Andrew Baker created a simulated data (found <a href="https://github.com/scunning1975/mixtape/">here</a>) in order to
demonstrate the potential pit falls of using TWFE in a setting with
staggered treatment timing and temporal treatment dynamics. Below is an
aggregated version of this data where average outcomes are calculated by
time and treatment group.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>baker <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">&#39;https://github.com/scunning1975/mixtape/raw/master/baker.dta&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>baker<span class="sc">$</span>treated <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(baker<span class="sc">$</span>treat_date <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="fu">list</span>(<span class="at">y =</span> baker<span class="sc">$</span>y),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">year =</span> baker<span class="sc">$</span>year,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group =</span> baker<span class="sc">$</span>group),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                 mean)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tmp<span class="sc">$</span>year, tmp<span class="sc">$</span>y, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(tmp<span class="sc">$</span>group, .<span class="dv">4</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Outcome&quot;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmp<span class="sc">$</span>year[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">1</span>]],</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>      tmp<span class="sc">$</span>y[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">1</span>]],</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> tmp<span class="sc">$</span>group[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">1</span>]])</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmp<span class="sc">$</span>year[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">2</span>]],</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>      tmp<span class="sc">$</span>y[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">2</span>]],</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> tmp<span class="sc">$</span>group[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">2</span>]])</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmp<span class="sc">$</span>year[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">3</span>]],</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      tmp<span class="sc">$</span>y[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">3</span>]],</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> tmp<span class="sc">$</span>group[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">3</span>]])</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmp<span class="sc">$</span>year[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">4</span>]],</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      tmp<span class="sc">$</span>y[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">4</span>]],</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> tmp<span class="sc">$</span>group[tmp<span class="sc">$</span>group <span class="sc">==</span> <span class="fu">unique</span>(tmp<span class="sc">$</span>group)[<span class="dv">4</span>]])</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">unique</span>(baker<span class="sc">$</span>treat_date)<span class="sc">-</span><span class="fl">0.5</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>When estimating a simple TWFE model, the following is the estimate
generated by OLS:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(y <span class="sc">~</span> treat <span class="sc">|</span> id <span class="sc">+</span> year, <span class="at">data =</span> baker)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; OLS estimation, Dep. Var.: y</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Observations: 30,000 </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fixed-effects: id: 1,000,  year: 30</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Standard-errors: Clustered (id) </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treat -6.69019   0.670213 -9.98218 &lt; 2.2e-16 ***</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE: 29.1     Adj. R2: 0.803436</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Within R2: 0.003954</span></span></code></pre></div>
<p>Of course, the treatment effect is surely non-negative. Below, we
estimate TWFE, Sun &amp; Abraham, and LP-DiD models. Here, just to
exemplify another feature of the package, one can re-weight the
regression to obtain an ATT rather than a VWATT. Here, the results are
nearly identical to the estimates via Sun &amp; Abraham. Also, note that
the window (<code>(-20, 20)</code>) is wider than what is plotted
<code>(-17, 17)</code>. This is a feature since the FEs and the
treatment variable are perfectly colinear outside what is returned.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>res_naive <span class="ot">=</span> <span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">i</span>(time_til, treated, <span class="at">ref =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">|</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                    id <span class="sc">+</span> year,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                  baker, <span class="at">cluster =</span> <span class="sc">~</span>state)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>res_cohort <span class="ot">=</span> <span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">sunab</span>(treat_date, year) <span class="sc">|</span> id <span class="sc">+</span> year, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                   baker[baker<span class="sc">$</span>year<span class="sc">&lt;</span><span class="dv">2004</span>,],</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cluster =</span> <span class="sc">~</span>state)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lpdid</span>(<span class="at">df =</span> baker, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">unit_index =</span> <span class="st">&quot;id&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">rel_time =</span> <span class="st">&quot;time_til&quot;</span>, <span class="at">reweight =</span> <span class="cn">TRUE</span>) <span class="ot">-&gt;</span> reg</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="fu">iplot</span>(res_naive, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">grid =</span> F,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Time to Treatment&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="fu">iplot</span>(res_cohort, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lpdid</span>(reg, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;TWFE&quot;</span>, <span class="st">&quot;Sun &amp; Abraham&quot;</span>, <span class="st">&quot;LP-DiD&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>It is also possible to pool together the treatment effects and get
standard errors using the <code>lpdid</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lpdid</span>(<span class="at">df =</span> baker, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">unit_index =</span> <span class="st">&quot;id&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">rel_time =</span> <span class="st">&quot;time_til&quot;</span>, <span class="at">reweight =</span> <span class="cn">TRUE</span>, <span class="at">pooled =</span> <span class="cn">TRUE</span>) <span class="ot">-&gt;</span> reg</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>reg<span class="sc">$</span>coeftable</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Estimate Std. Error  t value Pr(&gt;|t|)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 21  83.0089  0.7593857 109.3106        0</span></span></code></pre></div>
</div>
<div id="non-absorbing-treatment" class="section level2">
<h2>Non-Absorbing Treatment</h2>
<p>A final feature of the package (that is still under construction), is
handling non-absorbing treatment. The treatment example used in Dube et
al. (2023) is changes in the minimum wage. It is impossible to find a
“clean control” since all states have increased the minimum wage at one
point or another. So, the authors (see also <a href="https://doi.org/10.1093/qje/qjz014">Cengiz et al., 2019</a>) make
an assumption that <span class="math inline">\(L\)</span> time periods
after treatment, the effect “stabilizes”. See the text for more
details.</p>
<p>Below, we simulate data where there are three groups. First, there is
an untreated group. Second, there is a group that gets treated only a
single time. Finally, there is a group that is treated twice. The effect
sizes are 15 and 35 for first and second treatments. The aggregated time
series plots can be seen below.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">757</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">50</span>; T <span class="ot">&lt;-</span> <span class="dv">50</span>; N <span class="ot">&lt;-</span> I <span class="sc">*</span> T; e_var <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>I, <span class="at">each =</span> T),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">t =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>T, I),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">e =</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, e_var)) <span class="ot">-&gt;</span> df</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>unit_FE <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(I, <span class="dv">0</span>, e_var)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>time_FE <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(T, <span class="dv">0</span>, e_var)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treated <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">21</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat_status <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">21</span> <span class="sc">&amp;</span> df<span class="sc">$</span>t <span class="sc">%in%</span> <span class="dv">16</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat_status <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">11</span> <span class="sc">&amp;</span> df<span class="sc">$</span>t <span class="sc">%in%</span> <span class="dv">36</span><span class="sc">:</span><span class="dv">45</span>, <span class="dv">1</span>, df<span class="sc">$</span>treat_status)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>y <span class="ot">&lt;-</span> df<span class="sc">$</span>e <span class="sc">+</span> unit_FE[df<span class="sc">$</span>id] <span class="sc">+</span> time_FE[df<span class="sc">$</span>t] <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">11</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(df<span class="sc">$</span>t <span class="sc">&gt;</span> <span class="dv">35</span>, <span class="dv">50</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ifelse</span>(df<span class="sc">$</span>t <span class="sc">&gt;</span> <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">0</span>)),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(df<span class="sc">$</span>id <span class="sc">&lt;</span> <span class="dv">21</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ifelse</span>(df<span class="sc">$</span>t <span class="sc">&gt;</span> <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">0</span>),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span>))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> (<span class="fu">ave</span>(df<span class="sc">$</span>treat_status, df<span class="sc">$</span>id)) <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(df<span class="sc">$</span>y, <span class="fu">list</span>(df<span class="sc">$</span>t, df<span class="sc">$</span>group), mean)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg<span class="sc">$</span>Group<span class="fl">.1</span>, agg<span class="sc">$</span>x, <span class="at">col =</span> agg<span class="sc">$</span>Group<span class="fl">.2</span> <span class="sc">+</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Outcome&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Notice the differences in this function call versus the previous
ones. First, there is no <code>rel_time</code> arguement needed. This is
because rel_time does not necessarily make sense for a unit that is
treated more than once. Second, reweighting does not currently work when
<code>nonabsorbing = TRUE</code>. Currently, the reweighting simply gets
turned off when <code>nonabsorbing = TRUE</code>.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Finally, and perhaps
most importantly, notice the <code>nonabsorbing_treat_status</code>
variable. One must insert the name of a variable that details the
treatment status of the unit at every point. Unfortunately, this portion
of the package is still under construction. To give users an idea of
what the variable must look like, consider a unit that is treated in
both 1995 and 2010. Assume that treatment dynamics last only for 5
years. Then, observations of <code>nonabsorbing_treat_status</code>
should be: - 0 before 1995 - 1 between and including 1995 to 1999 - 0
between and including 2000 to 2009 - 1 between and including 2010 to
2014 - 0 after and including 2015</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lpdid</span>(<span class="at">df =</span> df, <span class="at">window =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">12</span>, <span class="dv">12</span>), <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">unit_index =</span> <span class="st">&quot;id&quot;</span>, <span class="at">time_index =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">nonabsorbing =</span> <span class="cn">TRUE</span>, <span class="at">nonabsorbing_lag =</span> <span class="dv">5</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">nonabsorbing_treat_status =</span> <span class="st">&quot;treat_status&quot;</span>) <span class="ot">-&gt;</span> reg</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lpdid</span>(reg)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(<span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">35</span>)), <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="under-construction" class="section level2">
<h2>Under Construction</h2>
<p>This is the first iteration of this package. So, of course, there are
some known (and surely many unknown) bugs. Some of them are as
follows:</p>
<ul>
<li>Thing 1</li>
<li>Thing 2</li>
</ul>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>This function is under development. Currently, the
parameters are fixed, so the only options are the exogeneity of the
treatment timing and the random number seed. The intention is to allow
for full control over the parameters so users can experiment.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>As a note, pooling with controls (or outcome lags) is
also not working.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
